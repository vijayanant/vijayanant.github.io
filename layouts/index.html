{{ define "main" }}
    {{ partial "hero.html" . }}

    {{/* --- Featured Series Section --- */}}
    <section id="series" style="padding: 4rem 0; background-color: var(--surface-color);">
        <div class="container">
            <h2 class="section-title">The Big Picture</h2>
            <p class="section-intro">Some topics are too complex for a single post. These are my deep dives into the systems and patterns that matter most.</p>
            
            <div class="blog-grid">
                {{/* Get the "series" taxonomy pages sorted by Date Descending, limit to 3 */}}
                {{ $series := .Site.GetPage "taxonomy" "series" }}
                {{ range first 3 $series.Pages.ByDate.Reverse }}
                    {{ partial "series-card.html" . }}
                {{ end }}
            </div>
            
            <div class="text-center" style="margin-top: 3rem;">
                <a href="/series/" class="button button-primary">View All Series &rarr;</a>
            </div>
        </div>
    </section>

    <hr class="section-divider">

    {{/* --- Recent Essays Section --- */}}
    <section id="writing" style="padding: 4rem 0;">
        <div class="container">
            <h2 class="section-title">Latest Essays</h2>
            <p class="section-intro">My latest thinking on code, complexity, and trade-offs.</p>

            <div class="blog-grid">
                {{/* Get the latest 3 regular pages from the "posts" section */}}
                {{ $posts := where .Site.RegularPages "Section" "posts" }}
                {{ range first 3 $posts }}
                    {{ partial "post-card.html" . }}
                {{ end }}
            </div>

            <div class="text-center" style="margin-top: 3rem;">
                <a href="/posts/" class="button button-primary">View Archive &rarr;</a>
            </div>
        </div>
    </section>

    <hr class="section-divider">

    {{/* --- Workshops & Speaking (Condensed) --- */}}
    {{ partial "speaking.html" . }}
    <hr class="section-divider">
    {{ partial "workshops.html" . }}

    <hr class="section-divider">

    {{/* --- Contact --- */}}
    {{ partial "contact.html" . }}

{{ end }}
