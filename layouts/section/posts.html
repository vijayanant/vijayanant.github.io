{{ define "main" }}
<section id="blog-list">
  <div class="container">

    {{ $allPosts := .Pages }} {{/* No pagination needed for <25 posts */}}

    {{ if gt (len $allPosts) 0 }}
      {{ $featuredPost := index $allPosts 0 }}
      {{ $remainingPosts := after 1 $allPosts }}

      {{/* Featured Post Section - Redesigned */}}
      <div class="featured-post-hero mb-5">
        {{ with $featuredPost }}
          {{ $postPermalink := .Permalink }}
          {{ with .Resources.GetMatch .Params.featured_image }}
            <a href="{{ $postPermalink }}" class="featured-post-link">
              {{ $heroImage := . }}
              {{ if ne .MediaType.SubType "svg" }}
                {{ $heroImage = .Fill "1200x600 webp" }}
              {{ end }}
              <img src="{{ $heroImage.RelPermalink }}" alt="{{ $featuredPost.Title }}" class="featured-post-hero-image" {{ if ne $heroImage.MediaType.SubType "svg" }}width="{{ $heroImage.Width }}" height="{{ $heroImage.Height }}"{{ end }}>
              <span class="featured-post-badge">Latest Article</span> <!-- NEW LINE -->
              <div class="featured-post-overlay">
                <h2 class="featured-post-hero-title">{{ $featuredPost.Title }}</h2>
                <div class="featured-post-hero-meta">{{ $featuredPost.Date.Format "January 2, 2006" }} &middot; {{ $featuredPost.ReadingTime }} min read</div>
                <p class="featured-post-hero-description">{{ $featuredPost.Description }}</p>
              </div>
            </a>
          {{ end }}
        {{ end }}
      </div>

      {{/* All Other Posts Grid */}}
      {{ if gt (len $remainingPosts) 0 }}
        <hr class="section-divider mt-5 mb-5">
        <h2 class="section-title mt-5">The Archive</h2>
        <div class="blog-grid">
          {{ range $remainingPosts }}
            <div class="post-card">
              {{ $postPermalink := .Permalink }}
              {{ with .Resources.GetMatch .Params.featured_image }}
              <a href="{{ $postPermalink }}">
                {{ $thumbnail := . }}
                {{ if ne .MediaType.SubType "svg" }}
                  {{ $thumbnail = .Fill "400x250 webp" }}
                {{ end }}
                <img src="{{ $thumbnail.RelPermalink }}" alt="{{ .Title }}" class="post-card-image" {{ if ne $thumbnail.MediaType.SubType "svg" }}width="{{ $thumbnail.Width }}" height="{{ $thumbnail.Height }}"{{ end }}> 
              </a>
              {{ else }}
              {{/* Optional: Add a fallback image here if no featured image is found */}}
              {{ end }}
              <h3 class="post-card-title">
                <a href="{{ .Permalink }}">{{ .Title }}</a>
              </h3>          
              <div class="post-card-meta">{{ .Date.Format "January 2, 2006" }} &middot; {{ .ReadingTime }} min read</div>
              <p class="post-card-description">{{ .Description | truncate 100 }}</p>
              <!-- <a href="{{ .Permalink }}" class="read-more-button">Read More â†’</a> -->
            </div>
          {{ end }}
        </div>
      {{ end }}

      {{/* Removed pagination partial */}}

    {{ else }}
      <p class="text-center">No posts found.</p>
    {{ end }}

  </div>
</section>
{{ end }}
