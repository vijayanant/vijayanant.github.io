{{ define "main" }}
<section id="blog-detail">
  <div class="container">

    <header class="series-list-header mb-4">
      <h1 class="section-title">Deep Dives</h1>
      <p class="section-intro">Curated paths through complex topics. Pick a thread and follow it.</p>
    </header>

    <div class="blog-grid">
      {{ $series := .Site.GetPage "taxonomy" "series" }}
      {{ range $series.Pages.ByDate.Reverse }}
        {{ $seriesPage := . }}
        <div class="post-card">
          {{ if eq $seriesPage.Params.status "Ongoing" }}
            <span class="series-status-badge status-ongoing">
              Ongoing
            </span>
          {{ end }}
          <a href="{{ $seriesPage.Permalink }}" class="post-card-link">
            {{ with $seriesPage.Params.featured_image }}
              {{ $image := $seriesPage.Resources.GetMatch . }}
              {{ if $image }}
                {{ $thumbnail := $image }}
                {{ if ne $image.MediaType.SubType "svg" }}
                  {{ $thumbnail = $image.Fill "400x250 webp" }}
                {{ end }}
                <img src="{{ $thumbnail.RelPermalink }}" alt="{{ $seriesPage.Title }}" class="post-card-image" {{ if ne $thumbnail.MediaType.SubType "svg" }}width="{{ $thumbnail.Width }}" height="{{ $thumbnail.Height }}"{{ end }}>
              {{ else }}
                {{ $thumbnail := resources.Get . }}
                {{ if $thumbnail }}
                  {{ if ne $thumbnail.MediaType.SubType "svg" }}
                    {{ $thumbnail = $thumbnail.Fill "400x250 webp" }}
                  {{ end }}
                  <img src="{{ $thumbnail.RelPermalink }}" alt="{{ $seriesPage.Title }}" class="post-card-image" {{ if ne $thumbnail.MediaType.SubType "svg" }}width="{{ $thumbnail.Width }}" height="{{ $thumbnail.Height }}"{{ end }}>
                {{ end }}
              {{ end }}
            {{ end }}
            <h2 class="post-card-title">
              <a href="{{ $seriesPage.Permalink }}">{{ $seriesPage.Title }}</a>
            </h2>
            <p class="post-card-description">{{ $seriesPage.Description | truncate 100 }}</p>
            <p class="post-card-meta text-muted">{{ len $seriesPage.Pages }} posts</p>
          </a>
        </div>
      {{ end }}
    </div>

  </div>
</section>
{{ end }}