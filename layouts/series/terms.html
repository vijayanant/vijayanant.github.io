{{ define "main" }}
<section id="blog-detail">
  <div class="container">

    <header class="series-list-header mb-4">
      <h1 class="section-title">All Series</h1>
      <p class="section-intro">Explore all available content series.</p>
    </header>

    <div class="blog-grid">
      {{ range .Data.Terms.ByCount }}
        {{ $seriesTerm := . }}
        {{ $seriesPage := site.GetPage (printf "series/%s" ($seriesTerm.Term | urlize)) }}
        <div class="post-card">
          <a href="{{ $seriesPage.Permalink }}" class="post-card-link">
            {{ with $seriesPage.Params.featured_image }}
              {{ $image := $seriesPage.Resources.GetMatch . }}
              {{ if $image }}
                {{ $thumbnail := $image }}
                {{ if ne $image.MediaType.SubType "svg" }}
                  {{ $thumbnail = $image.Fill "400x250 webp" }}
                {{ end }}
                <img src="{{ $thumbnail.RelPermalink }}" alt="{{ $seriesPage.Title }}" class="post-card-image" {{ if ne $thumbnail.MediaType.SubType "svg" }}width="{{ $thumbnail.Width }}" height="{{ $thumbnail.Height }}"{{ end }}>
              {{ else }}
                {{ $thumbnail := resources.Get . }}
                {{ if $thumbnail }}
                  {{ if ne $thumbnail.MediaType.SubType "svg" }}
                    {{ $thumbnail = $thumbnail.Fill "400x250 webp" }}
                  {{ end }}
                  <img src="{{ $thumbnail.RelPermalink }}" alt="{{ $seriesPage.Title }}" class="post-card-image" {{ if ne $thumbnail.MediaType.SubType "svg" }}width="{{ $thumbnail.Width }}" height="{{ $thumbnail.Height }}"{{ end }}>
                {{ end }}
              {{ end }}
            {{ end }}
            <h2 class="post-card-title">
              <a href="{{ $seriesPage.Permalink }}">{{ $seriesPage.Title }}</a>
            </h2>
            <p class="post-card-description">{{ $seriesPage.Description | truncate 100 }}</p>
            <p class="post-card-meta text-muted">{{ $seriesTerm.Count }} posts</p>
          </a>
        </div>
      {{ end }}
      {{ $numSeries := len .Data.Terms.ByCount }}
      {{ if eq $numSeries 2 }}
        <div class="post-card post-card-placeholder">
          <div class="placeholder-image"></div>
          <div class="placeholder-content">
            <div class="placeholder-line title"></div>
            <div class="placeholder-line meta"></div>
            <div class="placeholder-line description"></div>
          </div>
        </div>
      {{ else if eq $numSeries 1 }}
        <div class="post-card post-card-placeholder">
          <div class="placeholder-image"></div>
          <div class="placeholder-content">
            <div class="placeholder-line title"></div>
            <div class="placeholder-line meta"></div>
            <div class="placeholder-line description"></div>
          </div>
        </div>
        <div class="post-card post-card-placeholder">
          <div class="placeholder-image"></div>
          <div class="placeholder-content">
            <div class="placeholder-line title"></div>
            <div class="placeholder-line meta"></div>
            <div class="placeholder-line description"></div>
          </div>
        </div>
      {{ end }}
    </div>

  </div>
</section>
{{ end }}